# KindaLab challenge

------------
Elevator System

#### TECHNOLOGY STACK

* JAVA 17
* SPRING BOOT
* MONGO DB
* REDIS
* KAFKA
* DOCKER
* DOCKER-COMPOSE

#### Step by Step to run This APP

1- Build the Project

    mvn clean install

2- Run Docker compose. We need to raise kafka, redis and mongodb  

    docker-compose up -d

3- Run the project using Intellij. By default external.call is running in 5000 port and internal.call in 5001 port.

#### Description
Basically we have two microservices. External call microservice is in charge of the external requests of the elevator and basic authentication (user: **root**, pwd: **sasa**). Every request generate a unique ID to identify the request and is storage in a mongo db. 
The event is sent to kafka that queue the event in a topic.

To do an internal request we need the ID generated by the External module. I represented the Building in a Redis database, we the application start elevators are created if they weren't created before. 

I created a flowchart [here](https://github.com/janielHernandez/knl-challenge-elevator-system/blob/master/flowchart.jpeg).

### **External Call API**
If destination, in the public elevator is 50 (last floor) or -1 (basement) we need authentication.

* Public Elevator

    Post Request: localhost:5000/api/v1/call/public/{destination}
      
    Body: `{"origin": originFloor}`


* Freight Elevator

  Post Request: localhost:5000/api/v1/call/freight/{destination}

  Body: `{"origin": originFloor}`

### **Internal Call API**
Basically we have to send the ID generated before and the weight. I created a wrapper because from the origin floor maybe we need to transport one person or more. We also have a Get request to get the status of the elevator.
* Public Elevator

  Post Request: localhost:5001/api/v1/elevator/public

  Body: `{"origin": originFloor, "requesters": [{"id": ID_GENERATED, "weight": WEIGHT }]}`
  
  Get Request: localhost:5001/api/v1/elevator/public/status



* Freight Elevator

  Post Request: localhost:5001/api/v1/elevator/freight

  Body: `{"origin": originFloor, "requesters": [{"id": ID_GENERATED, "weight": WEIGHT }]}`

  Get Request: localhost:5001/api/v1/elevator/freight/status


